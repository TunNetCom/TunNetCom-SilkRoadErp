@using Radzen
@using Radzen.Blazor
@using Microsoft.Extensions.Localization
@using TunNetCom.SilkRoadErp.Sales.WebApp.Locales
@using TunNetCom.SilkRoadErp.Sales.WebApp.Components.Pages.DeliveryNotes
@inject DialogService DialogService
@inject IStringLocalizer<SharedResource> Localizer

<RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1rem">
    <RadzenText TextStyle="TextStyle.Body1">
        Ajouter un nouvel installateur
    </RadzenText>

    <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="0.5rem">
        <RadzenLabel Text="Nom *" />
        <RadzenTextBox @bind-Value="Nom"
                      Placeholder="Nom de l'installateur"
                      MaxLength="200"
                      Style="width: 100%;" />
    </RadzenStack>

    <RadzenRow>
        <RadzenColumn Size="12" SizeMD="4">
            <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="0.5rem">
                <RadzenLabel Text="Téléphone 1" />
                <RadzenTextBox @bind-Value="Tel"
                              Placeholder="Téléphone 1"
                              MaxLength="50"
                              Style="width: 100%;" />
            </RadzenStack>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="4">
            <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="0.5rem">
                <RadzenLabel Text="Téléphone 2" />
                <RadzenTextBox @bind-Value="Tel2"
                              Placeholder="Téléphone 2"
                              MaxLength="50"
                              Style="width: 100%;" />
            </RadzenStack>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="4">
            <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="0.5rem">
                <RadzenLabel Text="Téléphone 3" />
                <RadzenTextBox @bind-Value="Tel3"
                              Placeholder="Téléphone 3"
                              MaxLength="50"
                              Style="width: 100%;" />
            </RadzenStack>
        </RadzenColumn>
    </RadzenRow>

    <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="0.5rem">
        <RadzenLabel Text="Email" />
        <RadzenTextBox @bind-Value="Email"
                      Placeholder="Email"
                      MaxLength="200"
                      Style="width: 100%;" />
    </RadzenStack>

    <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="0.5rem">
        <RadzenLabel Text="Description" />
        <RadzenTextArea @bind-Value="Description"
                       Placeholder="Description"
                       Rows="2"
                       Style="width: 100%;" />
    </RadzenStack>

    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="0.5rem" JustifyContent="JustifyContent.End" Style="margin-top: 1rem;">
        <RadzenButton Text="@Localizer["Cancel"]"
                      ButtonStyle="ButtonStyle.Light"
                      Click="@(() => DialogService.Close(false))" />
        <RadzenButton Text="@Localizer["yes"]"
                      ButtonStyle="ButtonStyle.Success"
                      Click="@OnConfirm"
                      Disabled="@string.IsNullOrWhiteSpace(Nom)" />
    </RadzenStack>
</RadzenStack>

@code {
    private string Nom { get; set; } = string.Empty;
    private string? Tel { get; set; }
    private string? Tel2 { get; set; }
    private string? Tel3 { get; set; }
    private string? Email { get; set; }
    private string? Description { get; set; }

    private void OnConfirm()
    {
        if (string.IsNullOrWhiteSpace(Nom))
        {
            return;
        }

        var result = new CreateInstallationTechnicianDialogResult
        {
            Nom = Nom.Trim(),
            Tel = string.IsNullOrWhiteSpace(Tel) ? null : Tel.Trim(),
            Tel2 = string.IsNullOrWhiteSpace(Tel2) ? null : Tel2.Trim(),
            Tel3 = string.IsNullOrWhiteSpace(Tel3) ? null : Tel3.Trim(),
            Email = string.IsNullOrWhiteSpace(Email) ? null : Email.Trim(),
            Description = string.IsNullOrWhiteSpace(Description) ? null : Description.Trim()
        };

        DialogService.Close(result);
    }
}

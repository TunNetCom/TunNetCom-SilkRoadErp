@using Radzen
@using Radzen.Blazor
@using Microsoft.Extensions.Localization
@using TunNetCom.SilkRoadErp.Sales.WebApp.Locales
@using TunNetCom.SilkRoadErp.Sales.WebApp.Helpers
@inject DialogService DialogService
@inject IStringLocalizer<SharedResource> Localizer

<RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1rem">
    <RadzenText TextStyle="TextStyle.Body1">
        @Localizer["apply_discount_to_all"]
    </RadzenText>
    
    <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="0.5rem">
        <RadzenLabel Text="@Localizer["discount_percentage"]" />
        <RadzenNumeric @bind-Value="DiscountValue" 
                      Min="0" 
                      Max="@((decimal)MaxValue)" 
                      Step="0.01" 
                      Format="@AmountHelper.FORMAT_N2"
                      Style="width: 100%;"
                      Placeholder="0.00" />
    </RadzenStack>

    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="0.5rem" JustifyContent="JustifyContent.End" Style="margin-top: 1rem;">
        <RadzenButton Text="@Localizer["Cancel"]" 
                      ButtonStyle="ButtonStyle.Light" 
                      Click="@(() => DialogService.Close(false))" />
        <RadzenButton Text="@Localizer["apply"]" 
                      ButtonStyle="ButtonStyle.Success" 
                      Click="@OnConfirm" />
    </RadzenStack>
</RadzenStack>

@code {
    [Parameter] public double? InitialValue { get; set; }
    [Parameter] public double MaxValue { get; set; } = 50.0;
    
    private double? DiscountValue { get; set; }

    protected override void OnInitialized()
    {
        DiscountValue = InitialValue;
    }

    private void OnConfirm()
    {
        if (DiscountValue.HasValue)
        {
            DialogService.Close(DiscountValue.Value);
        }
        else
        {
            DialogService.Close(false);
        }
    }
}


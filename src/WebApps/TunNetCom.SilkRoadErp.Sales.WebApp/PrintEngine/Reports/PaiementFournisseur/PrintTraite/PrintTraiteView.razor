@using TunNetCom.SilkRoadErp.Sales.WebApp.Helpers
@using TunNetCom.SilkRoadErp.Sales.WebApp.PrintEngine.Reports.PaiementFournisseur.PrintTraite

@code {
    [Parameter] public PrintTraiteModel Model { get; set; } = null!;
}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        @@page {
            size: 297mm 210mm;
            margin: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            width: 297mm;
            height: 210mm;
            position: relative;
            background: transparent;
        }
        
        /* Positionnement absolu pour chaque valeur */
        .value-field {
            position: absolute;
            font-size: 11px;
            line-height: 1.2;
        }
        
        /* Couleurs selon le type */
        .tireur-value {
            color: #c00; /* Rouge */
            font-weight: 500;
        }
        
        .tire-value {
            color: #0066cc; /* Bleu */
            font-weight: 500;
        }
        
        .beneficiaire-value {
            color: #008000; /* Vert */
            font-weight: 500;
        }
        
        .montant-lettres {
            color: #008000; /* Vert */
            font-weight: 500;
            font-size: 10px;
            line-height: 1.3;
            max-width: 80mm;
        }
        
        .rib-value {
            font-family: monospace;
            font-size: 10px;
            letter-spacing: 1px;
        }
        
        .checkbox-mark {
            font-size: 14px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- Date d'échéance (haut centre, zone "Echéance") -->
    <div class="value-field tire-value" style="top: 28mm; left: 135mm; font-size: 11px;">
        @(Model.DateEcheance?.ToString("dd/MM/yyyy") ?? "")
    </div>
    
    <!-- Date de création "A Tunis Le" (haut centre, après échéance) -->
    <div class="value-field" style="top: 35mm; left: 120mm; font-size: 10px;">
        @Model.DateCreation.ToString("dd/MM/yyyy")
    </div>
    
    <!-- Numéro d'ordre de paiement L-CN (haut droite) -->
    <div class="value-field beneficiaire-value" style="top: 28mm; left: 215mm; font-size: 11px; font-weight: 500;">
        @Model.NumeroChequeTraite
    </div>
    
    <!-- Montant en chiffres (haut droite, première ligne) -->
    <div class="value-field beneficiaire-value" style="top: 35mm; left: 235mm; font-size: 13px; font-weight: bold;">
        @Model.Montant.ToString("N3", System.Globalization.CultureInfo.GetCultureInfo("fr-FR"))
    </div>
    
    <!-- Montant en chiffres (haut droite, deuxième ligne) -->
    <div class="value-field beneficiaire-value" style="top: 40mm; left: 235mm; font-size: 11px;">
        @Model.Montant.ToString("N3", System.Globalization.CultureInfo.GetCultureInfo("fr-FR"))
    </div>
    
    <!-- RIB/RIP du tiré (haut centre, zone RIB) -->
    <div class="value-field tire-value rib-value" style="top: 43mm; left: 125mm;">
        @if (!string.IsNullOrWhiteSpace(Model.Tire.RibFormatted))
        {
            <span>@Model.Tire.RibFormatted</span>
        }
    </div>
    
    <!-- Tireur (milieu gauche, zone "Tireur") -->
    <div class="value-field tireur-value" style="top: 68mm; left: 12mm; font-size: 11px; max-width: 90mm;">
        @Model.Tireur.Nom
    </div>
    
    <!-- Bénéficiaire "payer à l'ordre de" (milieu gauche, sous tireur) -->
    <div class="value-field beneficiaire-value" style="top: 88mm; left: 12mm; font-size: 11px; max-width: 90mm;">
        @Model.Tireur.Nom
    </div>
    
    <!-- Montant en lettres (milieu gauche, zone "Montant en lettres") -->
    <div class="value-field montant-lettres" style="top: 98mm; left: 12mm; max-width: 90mm;">
        @Model.MontantEnLettres
    </div>
    
    <!-- Lieu de création (milieu droite, zone "Lieu de création") -->
    <div class="value-field" style="top: 68mm; left: 195mm; font-size: 11px;">
        Tunis
    </div>
    
    <!-- Date de création (milieu droite, zone "Date de création") -->
    <div class="value-field" style="top: 75mm; left: 195mm; font-size: 11px;">
        @Model.DateCreation.ToString("dd/MM/yyyy")
    </div>
    
    <!-- Date d'échéance (milieu droite, zone "Echéance") -->
    <div class="value-field" style="top: 82mm; left: 195mm; font-size: 11px;">
        @(Model.DateEcheance?.ToString("dd/MM/yyyy") ?? "")
    </div>
    
    <!-- RIB/RIP du tiré (bas gauche, zone RIB/RIP) -->
    <div class="value-field tire-value rib-value" style="top: 143mm; left: 12mm;">
        @if (!string.IsNullOrWhiteSpace(Model.Tire.RibFormatted))
        {
            <span>@Model.Tire.RibFormatted</span>
        }
    </div>
    
    <!-- Nom et adresse du tiré (bas droite, zone "Nom et adresse du Tiré") -->
    <div class="value-field tire-value" style="top: 143mm; left: 195mm; font-size: 11px; max-width: 85mm; line-height: 1.3;">
        @Model.Tire.Nom
        @if (!string.IsNullOrWhiteSpace(Model.Tire.Adresse))
        {
            <br />@Model.Tire.Adresse
        }
    </div>
    
    <!-- Domiciliation/Banque (bas droite, zone "Domiciliation") -->
    <div class="value-field" style="top: 158mm; left: 195mm; font-size: 11px; max-width: 85mm; line-height: 1.3;">
        @if (Model.Banque != null)
        {
            <span>@Model.Banque.Nom</span>
            @if (!string.IsNullOrWhiteSpace(Model.Banque.Adresse))
            {
                <br />@Model.Banque.Adresse
            }
        }
    </div>
    
    <!-- Code-barres / Numéro (bas centre, zone code-barres) -->
    <div class="value-field" style="top: 188mm; left: 135mm; font-family: monospace; font-size: 11px; text-align: center; width: 30mm;">
        @if (!string.IsNullOrWhiteSpace(Model.NumeroChequeTraite))
        {
            <span>@Model.NumeroChequeTraite</span>
        }
    </div>
</body>
</html>
